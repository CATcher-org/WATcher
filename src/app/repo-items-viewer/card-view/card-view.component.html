<div class="card-column">
  <ng-container
    [ngTemplateOutlet]="getHeaderTemplate() || defaultHeader"
    [ngTemplateOutletContext]="{ $implicit: this.group }"
  ></ng-container>
  <div class="scrollable-container-wrapper scroll-shadow">
    <div class="scrollable-container">
      <div class="issue-pr-cards" *ngFor="let repoItem of this.repoItems$ | async; index as i">
        <app-issue-pr-card [repoItem]="repoItem" [filter]="repoItem.filter" [milestoneService]="milestoneService"></app-issue-pr-card>
      </div>
      <mat-card class="loading-spinner" *ngIf="this.repoItems.isLoading$ | async">
        <mat-progress-spinner color="primary" mode="indeterminate" diameter="50" strokeWidth="5"></mat-progress-spinner>
      </mat-card>
    </div>
  </div>
  <mat-paginator
    [pageSize]="pageSize"
    [hidePageSize]="true"
    [pageSizeOptions]="[10, 20, 50]"
    [class]="pageSize >= repoItemLength ? 'pagination-hide-arrow' : ''"
  ></mat-paginator>
</div>

<!-- Template -->
<ng-template #defaultHeader>
  <mat-card class="loading-spinner">
    <mat-progress-spinner color="primary" mode="indeterminate" diameter="50" strokeWidth="5"></mat-progress-spinner>
  </mat-card>
</ng-template>

<ng-template #assigneeHeader let-assignee>
  <div class="column-header">
    <mat-card>
      <mat-card-header [ngStyle]="{ height: '40px' }">
        <div
          mat-card-avatar
          *ngIf="assignee"
          [ngStyle]="{
            background: 'url(' + assignee.avatar_url + ')',
            'background-size': '40px'
          }"
        ></div>
        <mat-card-title>
          <div class="assignee-container">
            <div
              class="assignee-name no-select"
              (click)="goToGithubProfile(assignee.login)"
              [ngClass]="{ clickable: assignee.login !== 'Unassigned' }"
            >
              <span class="" [matTooltip]="getAssigneeTooltip(assignee)" matTooltipPosition="above">
                {{ assignee.login }}
              </span>
            </div>
            <div
              class="issue-row-count count-margins"
              [class.inactive]="!this.repoItems.hasIssue"
              [matTooltip]="getIssueTooltip()"
              matTooltipPosition="above"
              (click)="this.repoItems.hasIssue && filterByIssues()"
              [class.active]="currentFilter === 'issues'"
              [style.cursor]="this.repoItems.hasIssue ? 'pointer' : 'default'"
            >
              <span class="octicon count-margins" octicon="issue-opened"></span>
              <span class="">{{ this.repoItems.issueCount }}</span>
            </div>
            <div
              class="pr-row-count"
              [class.inactive]="!this.repoItems.hasPR"
              [matTooltip]="getPrTooltip()"
              matTooltipPosition="above"
              (click)="this.repoItems.hasPR && filterByPrs()"
              [class.active]="currentFilter === 'prs'"
              [style.cursor]="this.repoItems.hasPR ? 'pointer' : 'default'"
            >
              <span class="octicon count-margins" octicon="git-pull-request"></span>
              <span class="no-select">{{ this.repoItems.prCount }}</span>
            </div>
          </div>
        </mat-card-title>
      </mat-card-header>
    </mat-card>
  </div>
</ng-template>

<ng-template #milestoneHeader let-milestone>
  <div class="column-header">
    <mat-card>
      <mat-card-header [ngStyle]="{ height: '40px' }">
        <mat-card-title>
          <div class="milestone-container">
            <div class="no-select">
              {{ milestone.title }}
            </div>
            <div
              class="issue-row-count count-margins"
              [class.inactive]="!this.repoItems.hasIssue"
              [matTooltip]="getIssueTooltip()"
              matTooltipPosition="above"
              (click)="this.repoItems.hasIssue && filterByIssues()"
              [class.active]="currentFilter === 'issues'"
              [style.cursor]="this.repoItems.hasIssue ? 'pointer' : 'default'"
            >
              <span class="octicon count-margins" octicon="issue-opened"></span>
              <span class="no-select">{{ this.repoItems.issueCount }}</span>
            </div>
            <div
              class="pr-row-count"
              [class.inactive]="!this.repoItems.hasPR"
              [matTooltip]="getPrTooltip()"
              matTooltipPosition="above"
              (click)="this.repoItems.hasPR && filterByPrs()"
              [class.active]="currentFilter === 'prs'"
              [style.cursor]="this.repoItems.hasPR ? 'pointer' : 'default'"
            >
              <span class="octicon count-margins" octicon="git-pull-request"></span>
              <span class="no-select">{{ this.repoItems.prCount }}</span>
            </div>
          </div>
        </mat-card-title>
      </mat-card-header>
    </mat-card>
  </div>
</ng-template>
